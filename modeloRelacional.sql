DROP TABLE IF EXISTS PECA_CONDICIONAL;
DROP TABLE IF EXISTS VENDA_PECA;
DROP TABLE IF EXISTS COMPRA_PECA;
DROP TABLE IF EXISTS PECA;
DROP TABLE IF EXISTS CONDICIONAL;
DROP TABLE IF EXISTS VENDA;
DROP TABLE IF EXISTS CLIFISICO;
DROP TABLE IF EXISTS CLIJURIDICO;
DROP TABLE IF EXISTS CLIENTE;
DROP TABLE IF EXISTS COMPRA;
DROP TABLE IF EXISTS FORNECEDOR;
DROP TABLE IF EXISTS VENDEDOR;
DROP TABLE IF EXISTS ADM;
DROP TABLE IF EXISTS FUNCIONARIO;

CREATE TABLE FUNCIONARIO (
	idFunc INTEGER		PRIMARY KEY,
    cpf VARCHAR(11),
	nome VARCHAR(500),
	sexo VARCHAR(20),
    dataN DATE,
    telefone  VARCHAR(20),
    salario DECIMAL(10,2)
);

CREATE TABLE ADM (
	id INTEGER		PRIMARY KEY,
    FOREIGN KEY(id) REFERENCES FUNCIONARIO(idFunc) ON DELETE CASCADE
);

CREATE TABLE VENDEDOR (
	id INTEGER		PRIMARY KEY,
	comissão DECIMAL(10,2), 
    nivelDoVendedor VARCHAR(100),
    tempoDeServiço VARCHAR(100), 
	FOREIGN KEY(id) REFERENCES FUNCIONARIO (idFunc) ON DELETE CASCADE
);

CREATE TABLE FORNECEDOR (
	idFornecedor INTEGER	PRIMARY KEY,
	cnpj VARCHAR(14),
	nome VARCHAR(500),
	telefone VARCHAR(20)
);

CREATE TABLE COMPRA (
	idCompra INTEGER	PRIMARY KEY,
    idFornecedor INTEGER	NOT NULL,
    idADM INTEGER	NOT NULL,
    dataCompra DATE,
    precoT DECIMAL(10,2),
    FOREIGN KEY (idFornecedor) REFERENCES FORNECEDOR (idFornecedor),
    FOREIGN KEY (idADM) REFERENCES ADM (id)
);

CREATE TABLE CLIENTE (
	idCliente INTEGER	PRIMARY KEY,
    nome VARCHAR(500),
    sexo VARCHAR(20),
    dataNasc DATE,
    telefone  VARCHAR(20)
);

CREATE TABLE CLIJURIDICO (
	id INTEGER		PRIMARY KEY,
    cnpj VARCHAR(14),
    razaoSocial VARCHAR(500),
    siteEmpresa VARCHAR(500),
    FOREIGN KEY (id) REFERENCES CLIENTE (idCliente) ON DELETE CASCADE
);

CREATE TABLE CLIFISICO (
	id INTEGER		PRIMARY KEY,
    apelido VARCHAR(100),
    cpf VARCHAR(11),
    email VARCHAR(500),
    FOREIGN KEY (id) REFERENCES CLIENTE (idCliente) ON DELETE CASCADE
);

CREATE TABLE VENDA (
	idVenda INTEGER 	PRIMARY KEY,
    idFun INTEGER  	NOT NULL,
    idCli INTEGER 	NOT NULL,
    preçoT DECIMAL(10,2),
    dataVenda DATE,
    FOREIGN KEY (idFun) REFERENCES VENDEDOR (id),
    FOREIGN KEY (idCli) REFERENCES CLIENTE (idCliente)
);

CREATE TABLE CONDICIONAL (
	idCond INTEGER		PRIMARY KEY,
    qtde INTEGER,
    descricao VARCHAR(500),
    preco DECIMAL(10,2),
    idCli INTEGER  NOT NULL,
    FOREIGN KEY (idCli) REFERENCES CLIENTE (idCliente)
);

CREATE TABLE PECA (
	descricao VARCHAR(500)		PRIMARY KEY,
    qtdePeca INTEGER,
    preco DECIMAL(10,2)
);

CREATE TABLE COMPRA_PECA (
	idC INTEGER,
    descricao VARCHAR(500),
    qtde INTEGER,
    PRIMARY KEY(idC, descricao),
    FOREIGN KEY (idC) REFERENCES COMPRA (idCompra),
    FOREIGN KEY (descricao) REFERENCES PECA (descricao)
);

CREATE TABLE VENDA_PECA (
	idV INTEGER,
    descricao VARCHAR(500),
    qtde INTEGER, 
    PRIMARY KEY(idV, descricao),
    FOREIGN KEY (idV) REFERENCES VENDA (idVenda),
	FOREIGN KEY (descricao) REFERENCES PECA (descricao)
);

CREATE TABLE PECA_CONDICIONAL (
	id INTEGER,
    qtde INTEGER,
	descricao VARCHAR(500),
	PRIMARY KEY(id, descricao),
    FOREIGN KEY (id) REFERENCES CONDICIONAL (idCond),
    FOREIGN KEY (descricao) REFERENCES PECA (descricao)
);
